\section{Background}
\label{S:TBack}
\subsection{Trajectory Prediction}
\subsection{Datasets}
A review on the models used for pedestrian movement studies, with an emphasis on the behavioural models is presented in this section. In general, pedestrian movement models can be divided into two main categories: 1) Macroscopic models and 2) Microscopic models. In microscopic models, pedestrians are treated as agents, and are simulated individually. The main drawback of these type of models is the necessity of large and accurate data being available, as individual pedestrian movements require detailed information, based on different scenarios. On the other side, macroscopic models consider pedestrians only in groups \citep{sahaleh2012scenario}, and thus provide a rough estimate of the general movements of pedestrians in group exploiting less accurate data. For the purpose of our study, we focus on microscopic approaches in this section, where the trajectory prediction of pedestrians requires detailed information on movements of individuals.

Early models in the literature tried to assimilate pedestrian movements to that of ideal gases~\citep{henderson1974fluid} or fluids~\citep{helbing1998fluid}. However, the turning point in pedestrian movements modeling was the introduction of social force models by Helbing and Molnar in 1995~\citep{helbing1995social}. Based on the idea that behavioural changes are caused by so-called social fields, Helbing and Molnar described forces affecting pedestriansâ€™ behaviours as a result of internal motivations of an individual to decide and perform actions.

In 2004, Antonini~\textit{et al.}. started applying discrete choice models to pedestrian movement analysis using video recorded data \citep{antonini2004simulation}. The microscopic approach of the model allowed detailed analysis of movements of people. The choices that the pedestrians are facing at each time in their model were: 1. speed level and 2, discrete radial direction. Utility functions for each of these choices were defined based on attributes such as presence of obstacles, proximity to the destination and positions and speed of other pedestrians. Later works on these models added other variables, helping the model gain strength by the availability of observing various factors. For instance, Guo \textit{et al.} \citep{guo2012route} added visibility parameters to the model and Asano \textit{et al.} \citep{asano2010microscopic} later incorporated density. The major weaknesses of such microscopic methods using logit formulation is their: a) myopic nature, as they only predict the next step without considering the big picture in terms of steps before and upcoming obstacles and b) their requirement to discretize the space and speed into arbitrary levels.

Widespread success of machine learning methods in recent years, as well as the availability of large pedestrian datasets, have resulted in a shift of research trends to data-driven approaches in pedestrian studies. In one of the major earlier studies in the field, Alahi~\textit{et al.} introduced Social LSTM~\citep{alahi2016social}, a method that incorporated interactions among pedestrians in sequential models, namely Long Short-Term Memory (LSTM) to forecast trajectory of pedestrians using video footage of walking individuals in crowded scenes. In their method, a \textit{Social Pooling Layer} is added to the framework, through this layer, LSTM layers trained for individuals in a scene share their information. In spite of the success of social LSTM model in forecasting pedestrian's trajectory, this model does not account for the contextual information on the environment and aspects like where the pedestrian is looking. Thus making it difficult to apply to situations like road crossing behaviours of pedestrians in an autonomous environment. Furthermore, the future trajectory predicted by Social LSTM assumes a fixed length future trajectory. Lee~\textit{et al.} added semantic context to their proposed RNN model, \textit{DESIRE}~\citep{lee2017desire}, and predicted pedestrian trajectory of variable lengths in video data. More recently, Alahi~\textit{et al.} introduced \textit{Social GAN}~\citep{gupta2018social}, a model that predicts socially acceptable trajectories by training adversarial against a recurrent discriminator. Similar to \citep{alahi2016social}, this model fails to capture context information from the environment.

To the best of our knowledge, almost all the models in the literature have used general purpose video footage of pedestrian movements as the input data. Considering the fact that pedestrian road crossing behaviour in the presence of autonomous vehicles may differ, current datasets and scenarios may not be applicable to futuristic scenarios. To address this issue, we train and test our context-aware LSTM model on naturalistic virtual reality data collected in controlled experiments.     